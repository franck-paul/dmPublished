"use strict";dotclear.ready(()=>{dotclear.dmPublished=dotclear.getData("dm_published");const e=(e,o="toggle",l=null)=>{dotclear.dmViewPost(e,"dmrpe",l.metaKey)},o=()=>{dotclear.services("dmPublishedPostsCount",e=>{try{const o=JSON.parse(e);if(!o?.success)return void console.log(dotclear.debug&&o?.message?o.message:"Dotclear REST server error");if(o?.payload.ret){const{nb:e}=o.payload;dotclear.badge(document.querySelector("#published-posts"),{id:"dmrp",value:e,remove:e<=0,type:"soft"})}}catch(e){console.log(e)}},e=>{console.log(e)},!0,{json:1})},l=()=>{dotclear.services("dmPublishedCheck",o=>{try{const l=JSON.parse(o);if(!l?.success)return void console.log(dotclear.debug&&l?.message?l.message:"Dotclear REST server error");l?.payload.ret&&dotclear.services("dmPublisheduledRows",o=>{try{const l=JSON.parse(o);if(!l?.success)return void console.log(dotclear.debug&&l?.message?l.message:"Dotclear REST server error");if(l?.payload.ret){for(const e of document.querySelectorAll("#published-posts ul"))e.remove();for(const e of document.querySelectorAll("#published-posts p"))e.remove();const o=document.querySelector("#published-posts h3");o?.insertAdjacentHTML("afterend",l.payload.list),dotclear.expandContent({lines:document.querySelectorAll("#published-posts li.line"),callback:e});for(const e of document.querySelectorAll("#published-posts ul"))e.classList.add("expandable")}}catch(e){console.log(e)}},e=>{console.log(e)},!0,{json:1})}catch(e){console.log(e)}},e=>{console.log(e)},!0,{json:1})};dotclear.expandContent({lines:document.querySelectorAll("#published-posts li.line"),callback:e});for(const e of document.querySelectorAll("#published-posts ul"))e.classList.add("expandable");dotclear.dmPublished.monitor&&(dotclear.dmPublished.timer=setInterval(l,1e3*(dotclear.dmPublished.interval||300))),o(),dotclear.dmPublished.timer=setInterval(o,1e3*(dotclear.dmPublished.interval||300))});
