"use strict";dotclear.dmPublishedPostsCount=()=>{dotclear.services("dmPublishedPostsCount",(e=>{try{const s=JSON.parse(e);if(!s?.success)return void console.log(dotclear.debug&&s?.message?s.message:"Dotclear REST server error");if(s?.payload.ret){const{nb:e}=s.payload;dotclear.badge($("#published-posts"),{id:"dmrp",value:e,remove:e<=0,type:"soft"})}}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmLastPublishedRows=()=>{dotclear.services("dmPublisheduledRows",(e=>{try{const s=JSON.parse(e);if(!s?.success)return void console.log(dotclear.debug&&s?.message?s.message:"Dotclear REST server error");s?.payload.ret&&($("#published-posts ul").length&&$("#published-posts ul").remove(),$("#published-posts p").length&&$("#published-posts p").remove(),$("#published-posts h3").after(s.payload.list),$.expandContent({lines:$("#published-posts li.line"),callback:dotclear.dmPublishedPostsView}),$("#published-posts ul").addClass("expandable"))}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmPublishedCheck=()=>{dotclear.services("dmPublishedCheck",(e=>{try{const s=JSON.parse(e);if(!s?.success)return void console.log(dotclear.debug&&s?.message?s.message:"Dotclear REST server error");s?.payload.ret&&dotclear.dmLastPublishedRows()}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmPublishedPostsView=(e,s="toggle",l=null)=>{if(void 0===$(e).attr("id"))return;const o=$(e).attr("id").substring(4),t=`dmrpe${o}`;let d=document.getElementById(t);d?($(d).toggle(),$(e).toggleClass("expand")):dotclear.getEntryContent(o,(s=>{if(s)return d=document.createElement("li"),d.id=t,d.className="expand",$(d).append(s),$(e).addClass("expand"),void e.parentNode.insertBefore(d,e.nextSibling);$(e).toggleClass("expand")}),{clean:l.metaKey,length:300})},dotclear.ready((()=>{Object.assign(dotclear,dotclear.getData("dm_published")),$.expandContent({lines:$("#published-posts li.line"),callback:dotclear.dmPublishedPostsView}),$("#published-posts ul").addClass("expandable"),dotclear.dmPublished_Monitor&&(dotclear.dmPublished_Timer=setInterval(dotclear.dmPublishedCheck,1e3*(dotclear.dmPublished_Interval||300))),dotclear.dmPublishedPostsCount(),dotclear.dbPublishedPostsCount_Timer=setInterval(dotclear.dmPublishedPostsCount,1e3*(dotclear.dmPublished_Interval||300))}));
